!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";!function(){if(!window.javascriptJSBridgeChannel){var e={handlers:{},callbacks:{},promises:{},id:0,debug:!1,registerHandler:function(n,a){e.handlers[n]=a},unregisterHandler:function(n){if(!e.handlers[n])return;delete e.handlers[n]},callHandler:function(n,t){return function(n,t){if(!n)throw Error("javascriptJSBridgeChannel: handler name can not be null!!!");var i={id:e.id++,type:"request",resolved:!1,rejected:!1};i.action=n,t&&(t.data&&(i.data=t.data),e.callbacks[i.id]||(e.callbacks[i.id]={}),t.success&&(e.callbacks[i.id].success=t.success),t.fail&&(e.callbacks[i.id].fail=t.fail));if(a(i),/native code/.test(Promise.toString())&&"undefined"!=typeof Promise)return new Promise(((n,a)=>e.promises[i.id]={resolve:n,reject:a})).catch((function(e){}))}(n,t)},onMessageReceived:function(a){setTimeout((function(){!function(a){var i=decodeURIComponent(a),r=JSON.parse(i);n("[javascriptJSBridgeChannel receiveMessage]: ",r);var s=r;"request"===s.type&&function(n){function a(e){t(n={action:n.action,data:e,id:n.id,type:"response",resolved:!0,rejected:!1})}function i(e){t(n={action:n.action,data:e,id:n.id,type:"response",resolved:!1,rejected:!0})}var r=n.action;if(r in e.handlers){var s=(0,e.handlers[r])(n.data,(function(e){a(e)}),(function(e){i(e)}));"[object Promise]"==Object.prototype.toString.call(s)&&s.then((function(e){a(e)}),(function(e){i(e.toString)}))}else i(`handler name -> ${r} can't find!!!`)}(s);"response"===s.type&&function(n){var a=n.id,t=n.data,i=n.resolved,r=n.rejected;e.callbacks[a]&&(i&&e.callbacks[a].success&&e.callbacks[a].success(t),r&&e.callbacks[a].fail&&e.callbacks[a].fail(t),delete e.callbacks[a]);e.promises[a]&&(i&&e.promises[a].resolve(t),r&&e.promises[a].reject(t),delete e.promises[a])}(s)}(a)}),0)}};window.javascriptJSBridgeChannel={set debug(n){e.debug=n},registerHandler:e.registerHandler,unregisterHandler:e.unregisterHandler,callHandler:e.callHandler,onMessageReceived:e.onMessageReceived},setTimeout((()=>{var e=document,n=e.createEvent("Events"),a=window.WVJBCallbacks||[];n.initEvent("javascriptJSBridgeChannelReady"),n.bridge=javascriptJSBridgeChannel,delete window.WVJBCallbacks;for(var t=0;t<a.length;t++){(0,a[t])(javascriptJSBridgeChannel)}e.dispatchEvent(n)}),0),window.addEventListener("message",(e=>{window.eval(e.data)}))}function n(){if(e.debug){var n=Array.prototype.slice.call(arguments);console.log.apply(null,n)}}function a(e){n("[javascriptJSBridgeChannel postMessage]: ",e);var a=JSON.stringify(e),t=encodeURIComponent(a);self!=top?window.parent.postMessage(t,"*"):window.FlutterJSBridgeChannel&&window.FlutterJSBridgeChannel.postMessage(t)}function t(e){a(e)}}()}));
